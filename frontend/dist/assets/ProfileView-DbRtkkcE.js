import{l as k,_ as A,u as I,e as y,f as m,m as D,k as H,c as P,a as o,b as t,w as u,o as _,h as q,i as g,d as b,t as V}from"./index-BvqHgb2h.js";import{A as T}from"./AppHeader-C0SdLZh4.js";import{B as U}from"./BaseCard-ieAyc1Mh.js";import{B as h}from"./BaseButton-CaRIBqmI.js";import{B as w}from"./BaseInput-BXvUm3jM.js";const S={async getProfile(){return k.get("/users/profile")},async updateProfile(N){return k.put("/users/profile",N)},async changePassword(N){return k.put("/users/password",N)}},z={class:"profile-view"},G={class:"profile-view__main"},J={class:"container"},K={class:"profile-view__content"},Q={class:"profile-view__actions"},R={key:0,class:"profile-view__message profile-view__message--success"},W={key:1,class:"profile-view__message profile-view__message--error"},X={class:"profile-view__actions"},Y={key:0,class:"profile-view__message profile-view__message--success"},Z={key:1,class:"profile-view__message profile-view__message--error"},$={__name:"ProfileView",setup(N){const i=I(),r=y({firstName:"",lastName:"",email:""}),n=y({firstName:"",lastName:""}),C=m(!1),p=m(""),c=m(""),a=y({currentPassword:"",newPassword:"",confirmPassword:""}),l=y({currentPassword:"",newPassword:"",confirmPassword:""}),E=m(!1),v=m(""),f=m("");D(()=>{i.user&&(r.firstName=i.user.firstName,r.lastName=i.user.lastName,r.email=i.user.email)});const B=H(()=>i.user?r.firstName!==i.user.firstName||r.lastName!==i.user.lastName:!1),j=()=>{i.user&&(r.firstName=i.user.firstName,r.lastName=i.user.lastName),Object.keys(n).forEach(s=>{n[s]=""}),p.value="",c.value=""},F=()=>{Object.keys(a).forEach(s=>{a[s]=""}),Object.keys(l).forEach(s=>{l[s]=""}),v.value="",f.value=""},x=()=>{Object.keys(n).forEach(e=>{n[e]=""});let s=!0;return r.firstName.trim()||(n.firstName="First name is required",s=!1),r.lastName.trim()||(n.lastName="Last name is required",s=!1),s},M=()=>{Object.keys(l).forEach(e=>{l[e]=""});let s=!0;return a.currentPassword||(l.currentPassword="Current password is required",s=!1),a.newPassword?a.newPassword.length<6&&(l.newPassword="New password must be at least 6 characters",s=!1):(l.newPassword="New password is required",s=!1),a.confirmPassword?a.newPassword!==a.confirmPassword&&(l.confirmPassword="Passwords do not match",s=!1):(l.confirmPassword="Please confirm your new password",s=!1),s},O=async()=>{if(x()){C.value=!0,p.value="",c.value="";try{const s=await S.updateProfile({firstName:r.firstName.trim(),lastName:r.lastName.trim()});i.updateUser(s.user),p.value="Profile updated successfully"}catch(s){c.value=s.message||"Failed to update profile"}finally{C.value=!1}}},L=async()=>{if(M()){E.value=!0,v.value="",f.value="";try{await S.changePassword({currentPassword:a.currentPassword,newPassword:a.newPassword}),v.value="Password changed successfully",F()}catch(s){s.status===400?f.value="Current password is incorrect":f.value=s.message||"Failed to change password"}finally{E.value=!1}}};return(s,e)=>(_(),P("div",z,[o(T),t("main",G,[t("div",J,[e[12]||(e[12]=t("div",{class:"profile-view__header"},[t("h1",{class:"profile-view__title"},"Profile Settings"),t("p",{class:"profile-view__subtitle"},"Manage your account information and preferences")],-1)),t("div",K,[o(U,{class:"profile-view__card"},{header:u(()=>[...e[6]||(e[6]=[t("h3",null,"Personal Information",-1)])]),default:u(()=>[t("form",{onSubmit:q(O,["prevent"]),class:"profile-view__form"},[o(w,{modelValue:r.firstName,"onUpdate:modelValue":e[0]||(e[0]=d=>r.firstName=d),label:"First Name",placeholder:"Enter your first name",error:n.firstName,required:""},null,8,["modelValue","error"]),o(w,{modelValue:r.lastName,"onUpdate:modelValue":e[1]||(e[1]=d=>r.lastName=d),label:"Last Name",placeholder:"Enter your last name",error:n.lastName,required:""},null,8,["modelValue","error"]),o(w,{modelValue:r.email,"onUpdate:modelValue":e[2]||(e[2]=d=>r.email=d),label:"Email",type:"email",disabled:"",hint:"Email cannot be changed"},null,8,["modelValue"]),t("div",Q,[o(h,{type:"submit",loading:C.value,disabled:!B.value},{default:u(()=>[...e[7]||(e[7]=[b(" Update Profile ",-1)])]),_:1},8,["loading","disabled"]),o(h,{type:"button",variant:"outline",onClick:j,disabled:!B.value},{default:u(()=>[...e[8]||(e[8]=[b(" Cancel ",-1)])]),_:1},8,["disabled"])]),p.value?(_(),P("div",R,V(p.value),1)):g("",!0),c.value?(_(),P("div",W,V(c.value),1)):g("",!0)],32)]),_:1}),o(U,{class:"profile-view__card"},{header:u(()=>[...e[9]||(e[9]=[t("h3",null,"Change Password",-1)])]),default:u(()=>[t("form",{onSubmit:q(L,["prevent"]),class:"profile-view__form"},[o(w,{modelValue:a.currentPassword,"onUpdate:modelValue":e[3]||(e[3]=d=>a.currentPassword=d),label:"Current Password",type:"password",placeholder:"Enter your current password",error:l.currentPassword,required:""},null,8,["modelValue","error"]),o(w,{modelValue:a.newPassword,"onUpdate:modelValue":e[4]||(e[4]=d=>a.newPassword=d),label:"New Password",type:"password",placeholder:"Enter your new password (min. 6 characters)",error:l.newPassword,required:""},null,8,["modelValue","error"]),o(w,{modelValue:a.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=d=>a.confirmPassword=d),label:"Confirm New Password",type:"password",placeholder:"Confirm your new password",error:l.confirmPassword,required:""},null,8,["modelValue","error"]),t("div",X,[o(h,{type:"submit",loading:E.value},{default:u(()=>[...e[10]||(e[10]=[b(" Change Password ",-1)])]),_:1},8,["loading"]),o(h,{type:"button",variant:"outline",onClick:F},{default:u(()=>[...e[11]||(e[11]=[b(" Clear ",-1)])]),_:1})]),v.value?(_(),P("div",Y,V(v.value),1)):g("",!0),f.value?(_(),P("div",Z,V(f.value),1)):g("",!0)],32)]),_:1})])])])]))}},le=A($,[["__scopeId","data-v-9ff3c4e6"]]);export{le as default};
